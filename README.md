sorry about how stupid and inefficient this code is.
(it is very unreadable)
(very much sorry)
